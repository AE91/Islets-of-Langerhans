\chapter{Resultater}

Der er i dette projekt udarbejdet en prototype, som kan undersøge muligheden for en automatiseret metode at isolerer langerhanske øer. Der er udviklet et færdig system, som har potentiale til at isolere langerhanske øer, det vil sige at produktet kan isolere plantefrø, som er brugt i en simuleringsvæske. Derfor er de mekaniske og elektriske dele på plads, til videre undersøgelser af konceptet. I projektet er der også opnået en billedebehandling der understøtter konceptet, i kraft af hastigheden af processeringen af de simuleret billeder. Der er brugt simulerede billeder, fordi det indkøbte kamera ikke har været af tilstrækkelig kvalitet. fxnote{den kan ikke sorter plantefrø endnu!}

\input{Hovedrapport/userinterface}

\subsection{Hardwaren}

Den overordnet funktion af hardwaren er, at pumpe opløsningsvæsken forbi kameraet hen forbi ventilen til \textit{wastebeholderen} eller beholderen til de isoleret langerhanske øer. For at fremvise projektets færdige resultater, er kredsløbet og layoutet til det udarbejdede printkort til produktet indsat her under på figur XX. Til et overordnet overblik over hardwaren i projektet henvises der til figur \ref{fig:bdd_Hardware}. Printkortet er lavet som et shield til \textit{Arduino} udviklingskortet. Shieldet kan sættes direkte oven på arduinoen, på printkortet er der stik til at forsyne og videregive signaler til hardware komponenterne. Komponenterne er pumpen, der skaber flowet i slangen, ventilen som isolerer øerne, kameralyset lyser øerne op så kameraet bedre kan detektere dem. Derudover er vægtcellen også forsynet i gennem printet. Printkortets layout er udarbejdet i \textit{Eagle}, hvor lagene er eksporteret til \textit{gerber} filer. Filerne er sendt til printfremstilling ved Ingeniørhøjskolens værksted.

\subsubsection{Det samlede kredsløb}

Kredsløbet for det samlede print er indsat her nedenfor, kredsløbet beskriver hvordan delene er forbundet. \fxnote{beskriv nærmere nær printet er lavet}
Se diagrammet for printet på figur XX

\subsubsection{Det færdig print layout}
Nedenfor på figur XX kan layoutet ses i \textit{Eagle}. På printet er der to integrerede kredsløb, den ene(IC1) er en L293D som bla. bliver brugt som motordriver i projektet. Motordriveren forsynes eksternt og bruger igennem denne til at forsyne motor, kameralys og ventil. Kort fortalt tager motordriveren signalet fra arduinoen og efterligner det, men i stedet leverer effekten i gennem den eksterne forsyning. Det andet(IC2) integrerede kredsløb består af en operationsforstærker, som primært har til opgave at forstærke outputtet fra vægtcellen til arduinoens analog-digital konverter(ADC). Det gøres fordi outputtet fra vægtcellen er i mV og arduinoens ADC har en arbejdsspænding på 0V til 5V.  

\subsection{Ikke-elektroniske dele}
De ikke-elektroniske dele, består af beholdere, slanger og adaptere. I projektet er der fokuseret på opløsningsbeholderen, hvor der er indkøbt en 250ml beholder med et specielt låg. Igennem låget går en teflonslange, for at tætne denne tilslutning er der en forskruning som både aflaster og tætner i låget. I låget er der også et luftfilter, som forhindre støv og andre små partikler for at komme ned i opløsningen. Filteret skal være der for at undgå dannelse af undertryk i beholder, når pumpen suger opløsningsvæsken igennem systemet. Da teflonslangen ikke er eftergivende, er der brugt silikoneslanger til stykket igennem pumpen og resten af systemet. Fordi teflonslangen er for hård til, at pumpen kan sammenpresse den og derved skabe flow i opløsningen. For at kunne gå fra teflonslangen til silikoneslangen er der brugt en adapter. Figur \ref{fig:nonelectronic} indeholder en illustration af ikke-elektroniske dele. Se styklisten mm. i projektdokumentation afsnit XX.
\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{billeder/Hovedrapport/ikkeelektronisk.pdf}
	\caption{Illustration af ikke elektroniske dele}
	\label{fig:nonelectronic}
\end{figure}

%\subsubsection{Styreenheden} 
%Til at kontroller hardware komponenterne i systemet er der brugt en styreenhed i form af et arduino udviklingsboard, som er velegnet til producering af prototyper som i dette projekt. Udover at styre komponenterne sikre arduinoen også integrationen, mellem computeren og hardwaren. Derfor er det styreenheden der kontroller flow hastigheden, styrken af kameralyset samt åbning og lukning af ventilen. Se afsnit XX i projektdokumentationen for uddybende dokumentation for design og implementering af styreenheden.

%\subsubsection{Motordriveren}
%Motordriveren bruges i systemet til at forsyne pumpen, ventil og kameralyset. Motordriveren er nødvendig da Arduinoen ikke kan trække strøm nok til, at trække de nævnte komponenter. Motordriveren består af en L293D\fxnote{er det for specifikt?}, som efterligner signalerne modtaget af arduinoen og videre giver dem til komponenterne, men med forsyning igennem en strømforsyning der i modsætning til arduinoen kan levere den nødvendige strøm. Ved PWM signalet hæver motordriveren amplituden, med strømforsyningensspænding i stedet for arduinoensspænding. Se afsnit XX i projektdokumentationen for uddybende dokumentation for design og implementering af motordriveren.

%\subsubsection{Ventil}
%Ventilen skal kort sagt isolere de langerhanske øer, når kameraet har detekteret en ø. For at være sikker på at isoleringen er succesfuld er der implementeret en tidsforsinkelse på ventil når den er åben. Denne tid er en prioritering for det er uønsket, at få rest vævet med i den isoleret ø beholder. Tiden er i projektet beregnet og senere estimeret ud fra forsøg med simuleringsvæsken. Se afsnit XX i projektdokumentationen for uddybende dokumentation for design og implementering af ventilen.

%\subsubsection{Pumpe}
%Pumpens opgave er at skabe et flow i slanger og der ved drive opløsningsvæsken forbi kameraet og hen til ventilen. I projektet er der brugt en peristaltisk pumpe, der skaber et flow ved at sammenpresse slangen ved rotation. Denne pumpe type skaber et stabilt flow med mulighed for variable hastighed, ved hjælp af PWM forsyning fra arduinoen igennem motordriveren. Se afsnit XX i projektdokumentationen for uddybende dokumentation for design og implementering af pumpen.

%\subsubsection{Vægtcellen}
%Vægtcellen vejer opløsningsbeholderen og stopper systemet når der ikke er mere væske i beholderen. Vægtcellens output er i millivolt hvilket har medført at det skulle forstærkes, for at ADCens opløsning på arduionen kunne udnyttes fuldt ud. Derfor er der brugt en operationsforstærker til dette formål. Yderligere er vægtcellen kalibreret i softwaren ved hjælp af lineær regression. Der kan læses mere omkring implementeringen af vægtcellen i afsnit XX for design og implementering af komponenten, både for software og hardware.

%\subsubsection{Kameralyset}
%I prototypen er der brugt fire lysdioder til, at have fuldstændig kontrol over lyset til kameraet. Det er erfaret igennem enhedstest af kameraet, at lyset som påvirker kameraet er meget vigtig for detektionen af øerne. Se afsnit XX i projektdokumentationen for yderligere dokumentation af kameralyset.

 \section{Ventil tidsinterval}
Tidsintervallet mellem kameraet og ventilen er en vigtig faktor i systemet. Fordi intervallet beskriver tiden fra, at kameraet har detekteret en ø til den er kommet hen til ventilen, hvor den skal isoleres. En estimation er beregnet igennem nedenstående formler. Kravet fra kunden hedder 30 øer i minuttet, derfor skal systemet som minimum have en flow hastighed på 11,25 ml/min. Se formel \ref{eg:ohastighed} for udregningen. På figur \ref{fig:tidsintervalventil} kan der ses en illustration af problemstillingen,

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{billeder/Hovedrapport/tidsinterval.pdf}
	\caption{Illustration af ventil timerdelayet}
	\label{fig:tidsintervalventil}
\end{figure}

\begin{align}
\frac{\text{Opløsningsstørrelse}}{\text{Antal øer i opløsning}} = \frac{\SI{150}{\milli\liter}}{400\text{ øer}}*30 = \SI{11,25}{\milli\liter/minut} 
\label{eg:ohastighed}
\end{align}(\textit{jf. Søren Gregersen})

For at sorteringen af langerhanske øer er succesfuld, kræver det en beregning af den tid det tager for en langerhansk ø, at komme fra kameraet til ventilen. Det kan estimeres ud fra det volumenet af slangen, i mellem kameraet og ventil \ref{eg:slangevolume}.

\begin{align}
V=\pi*r^2*h=\pi*\frac{\SI{51}{\micro\metre}}{2}*\SI{5}{\centi\metre}=\SI{0,04}{\milli\liter}
\label{eg:slangevolume}
\end{align}

 Det vil sige at med et flow på $\SI{11,25}{\milli\liter/minut}$, som er beregnet ud fra formlen \ref{eg:ohastighed} kan tiden fra kamera til ventil beregnes ved formelen \ref{eq:tidsintervallet}. 
 
\begin{align}
\frac{\SI{11,25}{\milli\liter/minut}}{\SI{60}{\second}}=\SI{0,1875}{\milli\liter/s}\to\frac{\SI{0,04}{\milli\liter}}{\SI{0,1875}{\milli\liter/s}}=\SI{0.213}{\second}
\label{eq:tidsintervallet}
\end{align} 

i følge bilag \ref{bilag:ventil} har ventilen et volumen $\SI{27}{\micro\liter}$

\begin{align}
\text{Tid for udtømning af ventilen} = \frac{\text{ventil volume}}{\text{ml pr. sekund}}=\frac{\SI{27}{\micro\liter}}{\SI{0,1875}{\milli\liter/s}}=\SI{144}{\milli\second}
\label{eq:ventilvolume}
\end{align}

Fra de overstående beregninger kan det observeres, at tidsintervallet mellem kamera og ventilen er 213 millisekunder. Ud fra dette tidsinterval skal systemets tid fra, at kameraet har detekteret en ø til at ventilen kan åbne trækkes fra. Ligeledes skal ventilens lukketid også trækkes fra. I følge bilag \ref{bilag:ventil} har ventilen en åbningstid op til 20ms og en lukketid på op til 30ms. Til denne tid skal der yderligere tillægges tiden for kommunikation fra computer til arduino.
\begin{align}
Timerdelay=213ms-40ms-50ms=123ms
\label{eq:timerdelay}
\end{align} 
\fxnote{tiderne skal testes i en integrationstest}

Dette er tiden der skal gå fra kameraet har detekteret en ø, til den samme ø er ved ventilen. Der er implementeret et timer delay til dette i softwaren. For at være sikker på at øen bliver isoleret, er der implementeret endnu et timer delay der beskriver åbningstiden for ventilen. Til dette skal ventilen åbne lidt før og lukke lidt efter. Derfor bør tidsintervallet mellem kamera og ventil differentieres med 20ms og 20ms efter. I formel \ref{eq:ventilvolume} skal der bruges 144ms for at tømme ventilens volume, derfor er timerdelayet til åbningstiden for ventilen på 184ms. 
Åbningstiden er et kompromis, fordi det ikke er favorable at det eksokrine væv kommer over i den isoleret beholder, men samtidigt skal sandsynligheden for at ventilen er åben når øen kommer være så høj som mulig.

\input{Hovedrapport/kamera}

\section{Simuleringsvæske}
\label{sec:simuleringsv}
Da de langerhanske øer ikke er lettilgængelig, har det været nødsaget at finde et objekt til at agere aktør for cellerne. Simuleringsvæsken skal bruges til at teste de mekaniske dele, samt tidsintervallet mellem kameraet og ventilen. Egenskaberne af de langerhanske øer der er brugt til at finde simuleringsvæsken er at de er runde og lyse, størrelsen, samt at de bundfælder i colleganse opløsningen. Der har været to iterationer for at finde en aktør for cellerne, den første har bestået i at finde perfekte runde og hvide objekter med en $massefylde<1$. Til dette blev der brugt polysterene, som er lettilgængelig, samt runde, hvide og kan fåes med en massefylde lige over en \citep{polybog}. Dog blev det fundet svært at finde polysterene kugler i størrelsen 0.1-0.3mm, derfor blev der skabt kontakt til forhandlere af flamingo kugler. Dog var de tilsendte kugler for store, samt flød oven på. 

Den anden iteration bestod i at finde et biologisk materiale, hvor ved faktorerne runde og hvide blev nedprioriteret for at finde et objekt. For at finde en celle aktør med lettilgængelighed blev plantefrø den næste mulighed. Trods begrænset data omkring plantefrø, lykkes det gruppen at finde plantefrø i størrelsen 0.1-0.3mm vha. forhandlere af plantefrø og andre eksperter \ref{mailleverandor}. De indkøbte frø består af timian frø og rævehale frø, frøene kan ses på figur \ref{fig:timian} og \ref{fig:foxtail}.

 \begin{figure}[htbp] \centering
\begin{minipage}[b]{0.48\textwidth} \centering
\includegraphics[width=1.00\textwidth]{billeder/Hovedrapport/timian.jpg} % Left picture
\end{minipage} \hfill
\begin{minipage}[b]{0.48\textwidth} \centering
\includegraphics[width=1.00\textwidth]{billeder/Hovedrapport/foxtail.jpg} % Right picture
\end{minipage} \\ % Captions og labels
\begin{minipage}[b]{0.48\textwidth}
\caption{Billede af timian frø} % Left caption and label
\label{fig:timian}
\end{minipage} \hfill
\begin{minipage}[b]{0.48\textwidth}
\caption{Billede af rævehale frø} % Right caption and label
\label{fig:foxtail}
\end{minipage}
\end{figure}

Udover de indkøbte frø kan der ved videre bearbejdelse af projektet overvejes transparent testa (tt4 mutant) frø. De skulle i følge \textit{Carsten Meier} være hvide, forholdsvis runde, men ikke lige så tilgængelige, som de allerede indkøbte frø. Dette har været grunden til, at de ikke er brugt i projektet indtil nu. Derfor består den anvendte simuleringsvæske af, demineraliseret vand og timian plantefrø som aktør for de langerhanske øer.  
 
\section{Aceepttest af produktet} 
Til sidst i udviklingsforløbet blev der udført en accepttest af systemet. Den udførte accepttest er vedlagt i bilag XX. En række af kvalitetskravene blev ikke testet grundet kameraet ikke blev implementeret i prototypen. For hvert af kravene der ikke blev godkendt er der udfyldt en fejlrapport, hvor en handlingsplan beskriver hvordan og hvornår fejlen rettes. De udfyldte fejlrapporter er ligeledes vedlagt i bilag \ref{Fejlrapport}.

\input{Hovedrapport/costbenefit}